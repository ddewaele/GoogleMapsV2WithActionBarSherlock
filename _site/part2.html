<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Googlemapsv2withactionbarsherlock : This is a skeleton project for using Google Maps v2 on Android with ActionBarSherlock 4.3.1" />

    <link rel="stylesheet" type="text/css" media="screen" href="./stylesheets/stylesheet2.css">

    <title>Googlemapsv2withactionbarsherlock</title>
  </head>

  <body>
  
<a href="https://github.com/ddewaele/GoogleMapsV2WithActionBarSherlock"><img style="position: absolute; top: 0; right: 0; border: 0; -webkit-box-shadow: 0 0 0; box-shadow: 0 0 0; padding:0; margin:0" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub"></a>

    <!-- HEADER -->
    <div id="header_wrap" class="outer" style="background: url(./images/backdrop.png) center no-repeat;
">

          <h1 id="project_title"><a href="./" style="color:#FFFFFF">Maps V2 Android</a></h1>
          <div id="project_tagline">
              Guide for the new Android Maps V2 API.
              Includes a sample app, full source code, screencast and guides.
          </div>

        <header class="inner">
          <a id="forkme_banner" href="https://github.com/ddewaele/GoogleMapsV2WithActionBarSherlock">View on GitHub</a>


            <!--
            <section id="downloads">
              
              <a class="zip_download_link" href="https://github.com/ddewaele/GoogleMapsV2WithActionBarSherlock/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/ddewaele/GoogleMapsV2WithActionBarSherlock/tarball/master">Download this project as a tar.gz file</a>
            
            </section>
            -->
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
	<h2 id='markers'>Markers</h2>

<h3 id='introduction'>Introduction</h3>

<p>In the <a href='./part1'>previous part</a> I showed you how to create a skeleton project using the new Google Naps V2 API for Android.</p>

<p>In this part, I&#8217;ll show you some simple ways of dealing with Markers on your map.</p>

<p><a href='https://developers.google.com/maps/documentation/android/marker'>Markers</a> have finally become first class citizens in the Google Maps for Android v2 API.</p>

<p>Gone are the days where you need to work with low-level overlays and overlay items to get a simple marker on the Map.</p>

<p>As of v2, we finally have <code>Marker</code> objects and an <code>addMarkerToMap</code> method on the map, so let&#8217;s see what we can do with it&#8230;</p>

<p>But first we&#8217;re going to take a little side-track.</p>

<h3 id='adding_some_tabs_to_our_application'>Adding some tabs to our application.</h3>

<p>The next 4 parts in this series are included in a single Android demo application that can be downloaded from this <a href='https://github.com/ddewaele/GoogleMapsV2WithActionBarSherlock'>GitHub repository</a>. Each part of the series will be shown in an individual tab. For that I&#8217;m going to use a wonderful library from <a href='https://plus.google.com/117122118961369445953/posts'>Andreas Stütz</a> called <a href='https://github.com/astuetz/PagerSlidingTabStrip'>PagerSlidingTabStrip</a> that adds a nice set of tabs to the application. Setting up the project is really easy. Go checkout the Github page and download the library and the sample project if you&#8217;re interested in finding out more.</p>

<p>The main layout of the application looks like this:</p>
<div class='highlight'><pre><code class='xml'><span class='nt'>&lt;RelativeLayout</span> <span class='na'>xmlns:android=</span><span class='s'>&quot;http://schemas.android.com/apk/res/android&quot;</span>
	<span class='na'>xmlns:app=</span><span class='s'>&quot;http://schemas.android.com/apk/res-auto&quot;</span>
	<span class='na'>xmlns:tools=</span><span class='s'>&quot;http://schemas.android.com/tools&quot;</span>
	<span class='na'>android:layout_width=</span><span class='s'>&quot;match_parent&quot;</span>
	<span class='na'>android:layout_height=</span><span class='s'>&quot;match_parent&quot;</span> <span class='nt'>&gt;</span>

	<span class='nt'>&lt;FrameLayout</span>
		<span class='na'>android:id=</span><span class='s'>&quot;@+id/fragmentContainer&quot;</span>
		<span class='na'>android:layout_width=</span><span class='s'>&quot;fill_parent&quot;</span>
		<span class='na'>android:layout_height=</span><span class='s'>&quot;fill_parent&quot;</span> <span class='nt'>/&gt;</span>

	<span class='nt'>&lt;com.astuetz.viewpager.extensions.PagerSlidingTabStrip</span>
		<span class='na'>android:id=</span><span class='s'>&quot;@+id/tabs&quot;</span>
		<span class='na'>android:layout_width=</span><span class='s'>&quot;match_parent&quot;</span>
		<span class='na'>android:layout_height=</span><span class='s'>&quot;48dip&quot;</span>
		<span class='na'>android:background=</span><span class='s'>&quot;@drawable/background_tabs&quot;</span> <span class='nt'>/&gt;</span>

	<span class='nt'>&lt;com.ecs.google.maps.v2.component.CustomViewPager</span>
		<span class='na'>android:id=</span><span class='s'>&quot;@+id/pager&quot;</span>
		<span class='na'>android:layout_width=</span><span class='s'>&quot;match_parent&quot;</span>
		<span class='na'>android:layout_height=</span><span class='s'>&quot;wrap_content&quot;</span>
		<span class='na'>android:layout_below=</span><span class='s'>&quot;@+id/tabs&quot;</span>
		<span class='na'>tools:context=</span><span class='s'>&quot;.MainActivity&quot;</span> <span class='nt'>&gt;</span>
	<span class='nt'>&lt;/com.ecs.google.maps.v2.component.CustomViewPager&gt;</span>

<span class='nt'>&lt;/RelativeLayout&gt;</span>
</code></pre></div>
<p>The actual activity code is also pretty straightforward</p>

<p>We have maintain a reference to</p>

<ul>
<li>our <code>PagerSlidingTabStrip</code> component (responsible for drawing the tabs)</li>

<li>our <code>ViewPager</code> component (responsible for hosting the pages)</li>

<li>our <code>PagerAdapter</code> (responsible for providing the ViewPager with the pages).</li>
</ul>

<p>We glue them together by setting the PagerAdapter on the ViewPager, and attaching the ViewPager to the PagerSlidingTabStrip component.</p>
<div class='highlight'><pre><code class='java'><span class='kd'>public</span> <span class='kd'>class</span> <span class='nc'>TabbedActivity</span> <span class='kd'>extends</span> <span class='n'>SherlockFragmentActivity</span> <span class='o'>{</span> 

	<span class='kd'>private</span> <span class='n'>PagerSlidingTabStrip</span> <span class='n'>tabs</span><span class='o'>;</span>
	<span class='kd'>private</span> <span class='n'>ViewPager</span> <span class='n'>pager</span><span class='o'>;</span>
	<span class='kd'>private</span> <span class='n'>MyPagerAdapter</span> <span class='n'>adapter</span><span class='o'>;</span>

	<span class='nd'>@Override</span>
	<span class='kd'>protected</span> <span class='kt'>void</span> <span class='nf'>onCreate</span><span class='o'>(</span><span class='n'>Bundle</span> <span class='n'>savedInstanceState</span><span class='o'>)</span> <span class='o'>{</span>
		<span class='kd'>super</span><span class='o'>.</span><span class='na'>onCreate</span><span class='o'>(</span><span class='n'>savedInstanceState</span><span class='o'>);</span>
		<span class='n'>requestWindowFeature</span><span class='o'>(</span><span class='n'>Window</span><span class='o'>.</span><span class='na'>FEATURE_INDETERMINATE_PROGRESS</span><span class='o'>);</span>
		<span class='n'>setContentView</span><span class='o'>(</span><span class='n'>R</span><span class='o'>.</span><span class='na'>layout</span><span class='o'>.</span><span class='na'>activity_tabs</span><span class='o'>);</span>

		<span class='n'>tabs</span> <span class='o'>=</span> <span class='o'>(</span><span class='n'>PagerSlidingTabStrip</span><span class='o'>)</span> <span class='n'>findViewById</span><span class='o'>(</span><span class='n'>R</span><span class='o'>.</span><span class='na'>id</span><span class='o'>.</span><span class='na'>tabs</span><span class='o'>);</span>
		<span class='n'>pager</span> <span class='o'>=</span> <span class='o'>(</span><span class='n'>ViewPager</span><span class='o'>)</span> <span class='n'>findViewById</span><span class='o'>(</span><span class='n'>R</span><span class='o'>.</span><span class='na'>id</span><span class='o'>.</span><span class='na'>pager</span><span class='o'>);</span>
		<span class='n'>adapter</span> <span class='o'>=</span> <span class='k'>new</span> <span class='n'>MyPagerAdapter</span><span class='o'>(</span><span class='n'>getSupportFragmentManager</span><span class='o'>());</span>
		
		<span class='n'>pager</span><span class='o'>.</span><span class='na'>setAdapter</span><span class='o'>(</span><span class='n'>adapter</span><span class='o'>);</span>
		
		<span class='kd'>final</span> <span class='kt'>int</span> <span class='n'>pageMargin</span> <span class='o'>=</span> <span class='o'>(</span><span class='kt'>int</span><span class='o'>)</span> <span class='n'>TypedValue</span><span class='o'>.</span><span class='na'>applyDimension</span><span class='o'>(</span><span class='n'>TypedValue</span><span class='o'>.</span><span class='na'>COMPLEX_UNIT_DIP</span><span class='o'>,</span> <span class='mi'>8</span><span class='o'>,</span> <span class='n'>getResources</span><span class='o'>()</span>
				<span class='o'>.</span><span class='na'>getDisplayMetrics</span><span class='o'>());</span>
		<span class='n'>pager</span><span class='o'>.</span><span class='na'>setPageMargin</span><span class='o'>(</span><span class='n'>pageMargin</span><span class='o'>);</span>

		<span class='n'>tabs</span><span class='o'>.</span><span class='na'>setViewPager</span><span class='o'>(</span><span class='n'>pager</span><span class='o'>);</span>

	<span class='o'>}</span>
</code></pre></div>
<p>The component gives us a nice look and feel as far as tabs are concerned, resembling the way the Google Play store does it. I highly recommend you taking a look at the <a href='https://github.com/astuetz/PagerSlidingTabStrip'>PagerSlidingTabStrip</a> project.</p>

<h3 id='screenshots'>Screenshots</h3>

<h4 id='gingerbread'>Gingerbread</h4>

<p><img alt='gingerbread-tabs' src='https://dl.dropboxusercontent.com/u/13246619/Blog%20Articles/GoogleMapsV2/gingerbread-tabs.png' /></p>

<h3 id='ics_and_jelly_bean'>ICS and Jelly Bean</h3>

<p><img alt='jellybean-tabs' src='https://dl.dropboxusercontent.com/u/13246619/Blog%20Articles/GoogleMapsV2/jellybean-tabs.png' /></p>

<p>Note again that on Gingerbread (using a Samsung Galaxy S in this case), the overflow menu on the ActionBar is not shown because the device has a hardware menu button. On the Jelly Bean device (Samsung Galaxy Nexus) the overflow menu is shown.</p>

<h3 id='adding_markers_to_the_map'>Adding markers to the map</h3>

<p>Adding a marker to the map is very simple. The only thing you need to do is call the <code>addMarkerToMap</code> method on the googleMap. Notice how we also store the returned marker from the addMarkerToMap method in an ArrayList here in order to do some Marker management later on.</p>
<div class='highlight'><pre><code class='java'><span class='kd'>public</span> <span class='kt'>void</span> <span class='nf'>addMarkerToMap</span><span class='o'>(</span><span class='n'>LatLng</span> <span class='n'>latLng</span><span class='o'>)</span> <span class='o'>{</span>
	<span class='n'>Marker</span> <span class='n'>marker</span> <span class='o'>=</span> <span class='n'>googleMap</span><span class='o'>.</span><span class='na'>addMarker</span><span class='o'>(</span><span class='k'>new</span> <span class='n'>MarkerOptions</span><span class='o'>().</span><span class='na'>position</span><span class='o'>(</span><span class='n'>latLng</span><span class='o'>)</span>
			 <span class='o'>.</span><span class='na'>title</span><span class='o'>(</span><span class='s'>&quot;title&quot;</span><span class='o'>)</span>
			 <span class='o'>.</span><span class='na'>snippet</span><span class='o'>(</span><span class='s'>&quot;snippet&quot;</span><span class='o'>));</span>
	<span class='n'>markers</span><span class='o'>.</span><span class='na'>add</span><span class='o'>(</span><span class='n'>marker</span><span class='o'>);</span>

<span class='o'>}</span>
</code></pre></div>
<p>A title and snippet can be provided to be displayed on the <code>InfoWindow</code> when selecting the marker.</p>

<h3 id='marker_management'>Marker management</h3>

<p>The googleMap doesn&#8217;t expose a list of markers that have been added to the map, nor does it track the currently selected marker. In other words, you&#8217;ll need to do your own <code>marker management</code>. Marker management is all about having a flexible way to keep track of the markers being used on your app, so that you can refer to them in an easy way.</p>

<p>It comes in handy when you want to interact with markers without going through the standard callbacks of the googleMap.</p>

<p>When you have a marker somewhere on the map and you didn&#8217;t store the resulting marker in a list, the only way to access the marker again is by clicking on it, and using the marker argument in the callback.</p>
<div class='highlight'><pre><code class='java'>	
<span class='n'>googleMap</span><span class='o'>.</span><span class='na'>setOnMarkerClickListener</span><span class='o'>(</span><span class='k'>new</span> <span class='n'>GoogleMap</span><span class='o'>.</span><span class='na'>OnMarkerClickListener</span><span class='o'>()</span> <span class='o'>{</span>

			<span class='nd'>@Override</span>
			<span class='kd'>public</span> <span class='kt'>boolean</span> <span class='nf'>onMarkerClick</span><span class='o'>(</span><span class='n'>Marker</span> <span class='n'>marker</span><span class='o'>)</span> <span class='o'>{</span>
				<span class='k'>return</span> <span class='kc'>false</span><span class='o'>;</span>
			<span class='o'>}</span>
		<span class='o'>}</span>
<span class='o'>);</span>
</code></pre></div>
<p>If you wan to print all the markers on the map, programmatically highlight a specific marker, or jump from one marker to another you cannot do it unless you have some way of referencing these markers. By keeping the track of the markers in an external list we can add some flexibility regarding the way we can interact with these markers.</p>

<h3 id='the_selected_marker'>The selected marker</h3>

<p>It&#8217;s always interesting to know what marker is currently selected, and that&#8217;s also part of Marker management. Suppose you have a use-case where a user can select a marker, and pull up a menu to delete that marker. The action to delete the marker needs to know what marker should be deleted, so it needs to rely on an instance variable for that.</p>

<p>Our method to remove the selected marker would look like this:</p>
<div class='highlight'><pre><code class='java'><span class='kd'>public</span> <span class='kt'>void</span> <span class='nf'>removeSelectedMarker</span><span class='o'>()</span> <span class='o'>{</span>
	<span class='k'>this</span><span class='o'>.</span><span class='na'>markers</span><span class='o'>.</span><span class='na'>remove</span><span class='o'>(</span><span class='k'>this</span><span class='o'>.</span><span class='na'>selectedMarker</span><span class='o'>);</span>
	<span class='k'>this</span><span class='o'>.</span><span class='na'>selectedMarker</span><span class='o'>.</span><span class='na'>remove</span><span class='o'>();</span>
<span class='o'>}</span>
</code></pre></div>
<p>As we have a reference to the selected marker, it&#8217;s simply a matter of removing it from our internal list and removing it from the map. Keep in mind that it&#8217;s your responsibility to make sure the internal list is kept in sync with whatever is shown on the map.</p>

<h3 id='highlighting_a_marker'>Highlighting a marker</h3>

<p>If you want to highlight a marker, you typically want to change it&#8217;s appearance. One of the things you can change very easily now (since the latest Google Play Services update) is the icon on the map.</p>

<p>There are 2 ways to highlight a marker</p>

<ul>
<li>Clicking on a marker</li>

<li>Programmatically highlight a marker.</li>
</ul>

<h3 id='info_windows'>Info Windows</h3>

<p>The default behavior when clicking on a marker is</p>

<ul>
<li>move the camera to the marker</li>

<li>show an info window on the marker.</li>
</ul>

<p>If you want to intercept the user clicking on a marker, you simply need to implement an <code>OnMarkerClickListener</code></p>
<div class='highlight'><pre><code class='java'><span class='n'>googleMap</span><span class='o'>.</span><span class='na'>setOnMarkerClickListener</span><span class='o'>(</span><span class='k'>new</span> <span class='n'>GoogleMap</span><span class='o'>.</span><span class='na'>OnMarkerClickListener</span><span class='o'>()</span> <span class='o'>{</span>

			<span class='nd'>@Override</span>
			<span class='kd'>public</span> <span class='kt'>boolean</span> <span class='nf'>onMarkerClick</span><span class='o'>(</span><span class='n'>Marker</span> <span class='n'>marker</span><span class='o'>)</span> <span class='o'>{</span>
				<span class='k'>return</span> <span class='kc'>false</span><span class='o'>;</span>
			<span class='o'>}</span>
		<span class='o'>}</span>
<span class='o'>);</span>
</code></pre></div>
<ul>
<li>You return false if the default behavior should occur.</li>

<li>You return true if the listener has consumed the event and you don&#8217;t want the default behavior to occur).</li>
</ul>

<p>For example suppose you want to change the color of the marker when clicking on it, but you don&#8217;t want to shown the infoWindow or move the camera. In that case you could call the following function in the <code>onMarkerCick(Marker marker)</code>.</p>
<div class='highlight'><pre><code class='java'>	
<span class='kd'>private</span> <span class='kt'>void</span> <span class='nf'>highLightMarker</span><span class='o'>(</span><span class='n'>Marker</span> <span class='n'>marker</span><span class='o'>)</span> <span class='o'>{</span>
	
	<span class='k'>for</span> <span class='o'>(</span><span class='n'>Marker</span> <span class='n'>foundMarker</span> <span class='o'>:</span> <span class='k'>this</span><span class='o'>.</span><span class='na'>markers</span><span class='o'>)</span> <span class='o'>{</span>
		<span class='k'>if</span> <span class='o'>(!</span><span class='n'>foundMarker</span><span class='o'>.</span><span class='na'>equals</span><span class='o'>(</span><span class='n'>marker</span><span class='o'>))</span> <span class='o'>{</span>
			<span class='n'>foundMarker</span><span class='o'>.</span><span class='na'>setIcon</span><span class='o'>(</span><span class='n'>BitmapDescriptorFactory</span><span class='o'>.</span><span class='na'>defaultMarker</span><span class='o'>(</span><span class='n'>BitmapDescriptorFactory</span><span class='o'>.</span><span class='na'>HUE_RED</span><span class='o'>));</span>
		<span class='o'>}</span> <span class='k'>else</span> <span class='o'>{</span>
			<span class='n'>foundMarker</span><span class='o'>.</span><span class='na'>setIcon</span><span class='o'>(</span><span class='n'>BitmapDescriptorFactory</span><span class='o'>.</span><span class='na'>defaultMarker</span><span class='o'>(</span><span class='n'>BitmapDescriptorFactory</span><span class='o'>.</span><span class='na'>HUE_AZURE</span><span class='o'>));</span>
			<span class='n'>foundMarker</span><span class='o'>.</span><span class='na'>showInfoWindow</span><span class='o'>();</span>
		<span class='o'>}</span>
	<span class='o'>}</span>

	<span class='k'>this</span><span class='o'>.</span><span class='na'>selectedMarker</span><span class='o'>=</span><span class='n'>marker</span><span class='o'>;</span>
<span class='o'>}</span>
</code></pre></div>
<p>If you want to programmatically highlight a marker, and you either have a reference to it, or you know the index of the marker, simply call the highlightMarker directly. It will maintain the proper state (selectedMarker) and do the highlighting.</p>

<h3 id='custom_infowindows'>Custom InfoWindows</h3>

<p>The default infoWindow looks like this :</p>

<p><img alt='default-marker-infowindow.png' src='https://dl.dropboxusercontent.com/u/13246619/Blog%20Articles/GoogleMapsV2/default-marker-infowindow.png' /></p>

<p>You can customize the infoWindow by specifying your own layout file:</p>
<div class='highlight'><pre><code class='xml'><span class='cp'>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class='nt'>&lt;LinearLayout</span> <span class='na'>xmlns:android=</span><span class='s'>&quot;http://schemas.android.com/apk/res/android&quot;</span>
	<span class='na'>android:layout_width=</span><span class='s'>&quot;fill_parent&quot;</span>
	<span class='na'>android:layout_height=</span><span class='s'>&quot;wrap_content&quot;</span>
	<span class='na'>android:orientation=</span><span class='s'>&quot;horizontal&quot;</span><span class='nt'>&gt;</span>

	<span class='nt'>&lt;ImageView</span>
		<span class='na'>android:id=</span><span class='s'>&quot;@+id/icon&quot;</span>
		<span class='na'>android:layout_width=</span><span class='s'>&quot;wrap_content&quot;</span>
		<span class='na'>android:layout_height=</span><span class='s'>&quot;wrap_content&quot;</span>
		<span class='na'>android:layout_gravity=</span><span class='s'>&quot;center_vertical&quot;</span>
		<span class='na'>android:padding=</span><span class='s'>&quot;2dip&quot;</span>
		<span class='na'>android:src=</span><span class='s'>&quot;@drawable/ic_launcher&quot;</span>
		<span class='na'>android:contentDescription=</span><span class='s'>&quot;@string/icon&quot;</span><span class='nt'>/&gt;</span>

	<span class='nt'>&lt;LinearLayout</span>
		<span class='na'>android:layout_width=</span><span class='s'>&quot;fill_parent&quot;</span>
		<span class='na'>android:layout_height=</span><span class='s'>&quot;wrap_content&quot;</span>
		<span class='na'>android:orientation=</span><span class='s'>&quot;vertical&quot;</span><span class='nt'>&gt;</span>

		<span class='nt'>&lt;TextView</span>
			<span class='na'>android:id=</span><span class='s'>&quot;@+id/title&quot;</span>
			<span class='na'>android:layout_width=</span><span class='s'>&quot;wrap_content&quot;</span>
			<span class='na'>android:layout_height=</span><span class='s'>&quot;wrap_content&quot;</span>
			<span class='na'>android:textSize=</span><span class='s'>&quot;25sp&quot;</span>
			<span class='na'>android:textStyle=</span><span class='s'>&quot;bold&quot;</span><span class='nt'>/&gt;</span>

		<span class='nt'>&lt;TextView</span>
			<span class='na'>android:id=</span><span class='s'>&quot;@+id/snippet&quot;</span>
			<span class='na'>android:layout_width=</span><span class='s'>&quot;wrap_content&quot;</span>
			<span class='na'>android:layout_height=</span><span class='s'>&quot;wrap_content&quot;</span>
			<span class='na'>android:textSize=</span><span class='s'>&quot;15sp&quot;</span><span class='nt'>/&gt;</span>
	<span class='nt'>&lt;/LinearLayout&gt;</span>

<span class='nt'>&lt;/LinearLayout&gt;</span>
</code></pre></div>
<p>You also need to create an <code>InfoWindowAdapter</code> that will inflate the layout. The layout contains an icon and we set the title and the snippet on the layout as well, passing it in via the marker.</p>
<div class='highlight'><pre><code class='java'><span class='kn'>import</span> <span class='nn'>android.view.LayoutInflater</span><span class='o'>;</span>
<span class='kn'>import</span> <span class='nn'>android.view.View</span><span class='o'>;</span>
<span class='kn'>import</span> <span class='nn'>android.widget.TextView</span><span class='o'>;</span>

<span class='kn'>import</span> <span class='nn'>com.ecs.google.maps.v2.actionbarsherlock.R</span><span class='o'>;</span>
<span class='kn'>import</span> <span class='nn'>com.google.android.gms.maps.GoogleMap.InfoWindowAdapter</span><span class='o'>;</span>
<span class='kn'>import</span> <span class='nn'>com.google.android.gms.maps.model.Marker</span><span class='o'>;</span>

<span class='kd'>public</span> <span class='kd'>class</span> <span class='nc'>IconizedWindowAdapter</span> <span class='kd'>implements</span> <span class='n'>InfoWindowAdapter</span> <span class='o'>{</span>
  <span class='n'>LayoutInflater</span> <span class='n'>inflater</span><span class='o'>=</span><span class='kc'>null</span><span class='o'>;</span>

  <span class='kd'>public</span> <span class='nf'>IconizedWindowAdapter</span><span class='o'>(</span><span class='n'>LayoutInflater</span> <span class='n'>inflater</span><span class='o'>)</span> <span class='o'>{</span>
	<span class='k'>this</span><span class='o'>.</span><span class='na'>inflater</span><span class='o'>=</span><span class='n'>inflater</span><span class='o'>;</span>
  <span class='o'>}</span>

  <span class='nd'>@Override</span>
  <span class='kd'>public</span> <span class='n'>View</span> <span class='nf'>getInfoWindow</span><span class='o'>(</span><span class='n'>Marker</span> <span class='n'>marker</span><span class='o'>)</span> <span class='o'>{</span>
	<span class='k'>return</span><span class='o'>(</span><span class='kc'>null</span><span class='o'>);</span>
  <span class='o'>}</span>

  <span class='nd'>@Override</span>
  <span class='kd'>public</span> <span class='n'>View</span> <span class='nf'>getInfoContents</span><span class='o'>(</span><span class='n'>Marker</span> <span class='n'>marker</span><span class='o'>)</span> <span class='o'>{</span>
	<span class='n'>View</span> <span class='n'>popup</span><span class='o'>=</span><span class='n'>inflater</span><span class='o'>.</span><span class='na'>inflate</span><span class='o'>(</span><span class='n'>R</span><span class='o'>.</span><span class='na'>layout</span><span class='o'>.</span><span class='na'>marker_tooltip</span><span class='o'>,</span> <span class='kc'>null</span><span class='o'>);</span>

	<span class='n'>TextView</span> <span class='n'>tv</span><span class='o'>=(</span><span class='n'>TextView</span><span class='o'>)</span><span class='n'>popup</span><span class='o'>.</span><span class='na'>findViewById</span><span class='o'>(</span><span class='n'>R</span><span class='o'>.</span><span class='na'>id</span><span class='o'>.</span><span class='na'>title</span><span class='o'>);</span>

	<span class='n'>tv</span><span class='o'>.</span><span class='na'>setText</span><span class='o'>(</span><span class='n'>marker</span><span class='o'>.</span><span class='na'>getTitle</span><span class='o'>());</span>
	<span class='n'>tv</span><span class='o'>=(</span><span class='n'>TextView</span><span class='o'>)</span><span class='n'>popup</span><span class='o'>.</span><span class='na'>findViewById</span><span class='o'>(</span><span class='n'>R</span><span class='o'>.</span><span class='na'>id</span><span class='o'>.</span><span class='na'>snippet</span><span class='o'>);</span>
	<span class='n'>tv</span><span class='o'>.</span><span class='na'>setText</span><span class='o'>(</span><span class='n'>marker</span><span class='o'>.</span><span class='na'>getSnippet</span><span class='o'>());</span>

	<span class='k'>return</span><span class='o'>(</span><span class='n'>popup</span><span class='o'>);</span>
  <span class='o'>}</span>
<span class='o'>}</span>	
</code></pre></div>
<p>And finally we need to set the <code>InfoWindowAdapter</code> on the map</p>
<div class='highlight'><pre><code class='java'><span class='n'>googleMap</span><span class='o'>.</span><span class='na'>setInfoWindowAdapter</span><span class='o'>(</span><span class='k'>new</span> <span class='n'>IconizedWindowAdapter</span><span class='o'>(</span><span class='n'>getActivity</span><span class='o'>().</span><span class='na'>getLayoutInflater</span><span class='o'>()));</span>	
</code></pre></div>
<p>The result looks like this:</p>

<p><img alt='Custom infowindow' src='./images/custom-infowindow.png' /></p>

<h3 id='custom_markers'>Custom markers</h3>

<p>Besides having custom info windows, it&#8217;s also possible to put custom markers on the map. The easiest way to do that is to use the <code>setIcon</code> method on the <code>MarkerOptions</code>.</p>

<pre><code>markerOptions.icon(BitmapDescriptorFactory.fromResource(R.drawable.arrow)));</code></pre>

<p>For some more advanced custom markers, I recommend you checkout the excellent <a href='https://github.com/googlemaps/android-maps-utils'>android-maps-utils project on Github</a>.</p>

<p>It&#8217;s a library project that you can add to your project and offers a BubbleIconFactory capable of creating Bitmaps that can be put on your marker.</p>
<div class='highlight'><pre><code class='java'><span class='n'>BubbleIconFactory</span> <span class='n'>factory</span> <span class='o'>=</span> <span class='k'>new</span> <span class='n'>BubbleIconFactory</span><span class='o'>(</span><span class='n'>getActivity</span><span class='o'>());</span>
<span class='n'>factory</span><span class='o'>.</span><span class='na'>setStyle</span><span class='o'>(</span><span class='n'>Style</span><span class='o'>.</span><span class='na'>PURPLE</span><span class='o'>);</span>
<span class='n'>factory</span><span class='o'>.</span><span class='na'>setRotation</span><span class='o'>(</span><span class='mi'>360</span><span class='o'>);</span>
<span class='n'>factory</span><span class='o'>.</span><span class='na'>setContentRotation</span><span class='o'>(</span><span class='mi'>90</span><span class='o'>);</span>
<span class='n'>Bitmap</span> <span class='n'>bitmap</span> <span class='o'>=</span> <span class='n'>factory</span><span class='o'>.</span><span class='na'>makeIcon</span><span class='o'>(</span><span class='s'>&quot;This is a test&quot;</span><span class='o'>);</span>
</code></pre></div>
<p>The result looks like this:</p>

<p><img alt='BubbleIconFactory' src='https://dl.dropboxusercontent.com/u/13246619/Blog%20Articles/GoogleMapsV2/bubbleIconFactory.png' /></p>

<h3 id='some_useful_methods_to_have_to_manage_your_markers'>Some useful methods to have to manage your markers</h3>

<p>If you&#8217;re working with maps a lot, and you have more than one app that uses maps, it&#8217;s interesting to encapsulate all of this into your own custom map fragment. The following generic methods can be placed on the MapFragment so that you can not only drop the fragment into your layout, but also re-use a lot of the business logic associated with marker management.</p>

<p>Adds a marker to the map.</p>
<div class='highlight'><pre><code class='java'><span class='kd'>public</span> <span class='kt'>void</span> <span class='nf'>addMarkerToMap</span><span class='o'>(</span><span class='n'>LatLng</span> <span class='n'>latLng</span><span class='o'>)</span> <span class='o'>{</span>
	<span class='n'>Marker</span> <span class='n'>marker</span> <span class='o'>=</span> <span class='n'>googleMap</span><span class='o'>.</span><span class='na'>addMarker</span><span class='o'>(</span><span class='k'>new</span> <span class='n'>MarkerOptions</span><span class='o'>().</span><span class='na'>position</span><span class='o'>(</span><span class='n'>latLng</span><span class='o'>)</span>
			 <span class='o'>.</span><span class='na'>title</span><span class='o'>(</span><span class='s'>&quot;title&quot;</span><span class='o'>)</span>
			 <span class='o'>.</span><span class='na'>snippet</span><span class='o'>(</span><span class='s'>&quot;snippet&quot;</span><span class='o'>));</span>
	<span class='n'>markers</span><span class='o'>.</span><span class='na'>add</span><span class='o'>(</span><span class='n'>marker</span><span class='o'>);</span>

<span class='o'>}</span>
</code></pre></div>
<p>Clears all markers from the map.</p>
<div class='highlight'><pre><code class='java'><span class='kd'>public</span> <span class='kt'>void</span> <span class='nf'>clearMarkers</span><span class='o'>()</span> <span class='o'>{</span>
	<span class='n'>googleMap</span><span class='o'>.</span><span class='na'>clear</span><span class='o'>();</span>
	<span class='n'>markers</span><span class='o'>.</span><span class='na'>clear</span><span class='o'>();</span>		
<span class='o'>}</span>
</code></pre></div>
<p>Remove the currently selected marker.</p>
<div class='highlight'><pre><code class='java'><span class='kd'>public</span> <span class='kt'>void</span> <span class='nf'>removeSelectedMarker</span><span class='o'>()</span> <span class='o'>{</span>
	<span class='k'>this</span><span class='o'>.</span><span class='na'>markers</span><span class='o'>.</span><span class='na'>remove</span><span class='o'>(</span><span class='k'>this</span><span class='o'>.</span><span class='na'>selectedMarker</span><span class='o'>);</span>
	<span class='k'>this</span><span class='o'>.</span><span class='na'>selectedMarker</span><span class='o'>.</span><span class='na'>remove</span><span class='o'>();</span>
<span class='o'>}</span>	
</code></pre></div>
<p>Highlight the marker by index.</p>
<div class='highlight'><pre><code class='java'><span class='kd'>private</span> <span class='kt'>void</span> <span class='nf'>highLightMarker</span><span class='o'>(</span><span class='kt'>int</span> <span class='n'>index</span><span class='o'>)</span> <span class='o'>{</span>
	<span class='n'>highLightMarker</span><span class='o'>(</span><span class='n'>markers</span><span class='o'>.</span><span class='na'>get</span><span class='o'>(</span><span class='n'>index</span><span class='o'>));</span>
<span class='o'>}</span>
</code></pre></div>
<p>Highlight the marker by marker.</p>
<div class='highlight'><pre><code class='java'><span class='kd'>private</span> <span class='kt'>void</span> <span class='nf'>highLightMarker</span><span class='o'>(</span><span class='n'>Marker</span> <span class='n'>marker</span><span class='o'>)</span> <span class='o'>{</span>
	<span class='n'>marker</span><span class='o'>.</span><span class='na'>setIcon</span><span class='o'>(</span><span class='n'>BitmapDescriptorFactory</span><span class='o'>.</span><span class='na'>defaultMarker</span><span class='o'>(</span><span class='n'>BitmapDescriptorFactory</span><span class='o'>.</span><span class='na'>HUE_AZURE</span><span class='o'>));</span>
	<span class='n'>marker</span><span class='o'>.</span><span class='na'>showInfoWindow</span><span class='o'>();</span>
	<span class='k'>this</span><span class='o'>.</span><span class='na'>selectedMarker</span><span class='o'>=</span><span class='n'>marker</span><span class='o'>;</span>
<span class='o'>}</span>
</code></pre></div>
<h3 id='polylines'>Polylines</h3>

<p>You can also draw polyLines onto the map. For that you need to create a <code>Polyline</code> and a <code>PolylineOptions</code></p>
<div class='highlight'><pre><code class='java'><span class='kd'>private</span> <span class='n'>Polyline</span> <span class='n'>polyLine</span><span class='o'>;</span>
<span class='kd'>private</span> <span class='n'>PolylineOptions</span> <span class='n'>rectOptions</span> <span class='o'>=</span> <span class='k'>new</span> <span class='n'>PolylineOptions</span><span class='o'>();</span>
</code></pre></div>
<p>You get a reference to a polyLine by adding it to the map by calling the <code>addPolyLine</code> method.</p>
<div class='highlight'><pre><code class='java'><span class='n'>polyLine</span> <span class='o'>=</span> <span class='n'>googleMap</span><span class='o'>.</span><span class='na'>addPolyline</span><span class='o'>(</span><span class='n'>rectOptions</span><span class='o'>);</span>
</code></pre></div>
<p>In our sample, as we add markers to the map we also update the polyLine so that the markers are connected. We do this by adding our the newly dropped marker onto the polyLine. Notice how we need to call setPoints again. Simply doing polyLine.getPoints().add(latLng) doesn&#8217;t work.</p>
<div class='highlight'><pre><code class='java'>	
<span class='cm'>/**</span>
<span class='cm'> * Add the marker to the polyline.</span>
<span class='cm'> */</span>
<span class='kd'>private</span> <span class='kt'>void</span> <span class='nf'>updatePolyLine</span><span class='o'>(</span><span class='n'>LatLng</span> <span class='n'>latLng</span><span class='o'>)</span> <span class='o'>{</span>
	<span class='n'>List</span><span class='o'>&lt;</span><span class='n'>LatLng</span><span class='o'>&gt;</span> <span class='n'>points</span> <span class='o'>=</span> <span class='n'>polyLine</span><span class='o'>.</span><span class='na'>getPoints</span><span class='o'>();</span>
	<span class='n'>points</span><span class='o'>.</span><span class='na'>add</span><span class='o'>(</span><span class='n'>latLng</span><span class='o'>);</span>
	<span class='n'>polyLine</span><span class='o'>.</span><span class='na'>setPoints</span><span class='o'>(</span><span class='n'>points</span><span class='o'>);</span>
<span class='o'>}</span>
</code></pre></div>
<h3 id='reusability'>Re-usability</h3>

<p>A lot of the stuff we&#8217;ve discussed here are generic / re-usable that you want to have at your disposal when dealing with maps. It&#8217;s important to position them on the proper level in your code.</p>

<p>Placing them on a custom <code>MapFragment</code> subclass is an ideal way to promote re-use as</p>

<ul>
<li>the methods are tightly coupled with the map</li>

<li>the methods are eligable for re-used</li>

<li>the MapFragment containing these methods can be easily embedded in another layout</li>
</ul>

<h2 id='references'>References</h2>

<ul>
<li><a href='https://developers.google.com/maps/documentation/android/marker'>Android Markers</a></li>

<li><a href='https://plus.google.com/117122118961369445953/posts'>Andreas Stütz</a></li>

<li><a href='https://github.com/astuetz/PagerSlidingTabStrip'>PagerSlidingTabStrip</a></li>

<li><a href='http://www.youtube.com/watch?feature=player_embedded&amp;v=nb2X9IjjZpM#!'>Maps Shortcuts: Android Maps Utility Library</a></li>

<li><a href='https://github.com/googlemaps/android-maps-utils'>Android Maps Utils library</a></li>
</ul>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Googlemapsv2withactionbarsherlock maintained by <a href="https://github.com/ddewaele">ddewaele</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
